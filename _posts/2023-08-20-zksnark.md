---
layout: post

title: Quyá»n riÃªng tÆ° trÃªn blockchain vÃ  Zk-SNARK
category: [blockchain, cs251]
tags: [knowledge]

---

Trong há»‡ thá»‘ng tÃ i chÃ­nh, viá»‡c riÃªng tÆ° lÃ  Ä‘iá»u cáº§n thiáº¿t. Má»™t vÃ i vÃ­ dá»¥ nhÆ°: Má»™t nhÃ  sáº£n xuáº¥t khÃ´ng muá»‘n tiáº¿t lá»™ sá»‘ tiá»n há» tráº£ cho nhÃ  cung cáº¥p cá»§a mÃ¬nh cho cÃ¡c bá»™ pháº­n, NgÆ°á»i dÃ¹ng cuá»‘i cáº§n quyá»n riÃªng tÆ° Ä‘á»ƒ thuÃª, quyÃªn gÃ³p, mua hÃ ng,... Do Ä‘Ã³, blockchain khÃ´ng thá»ƒ phÃ¡t huy háº¿t tiá»m nÄƒng náº¿u khÃ´ng cÃ³ má»™t sá»‘ Tx riÃªng tÆ°.

## Sá»± riÃªng tÆ° trong cÃ¡c blockchain
- Vá»›i Ethereum, má»i sá»‘ dÆ° Ä‘á»u cÃ´ng khai. Trong cÃ¡c DApps, code vÃ  state cÅ©ng cÃ´ng khai cho ngÆ°á»i dÃ¹ng. NgoÃ i ra, cÃ¡c Tx cÅ©ng ná»‘i Ä‘áº¿n cÃ¡c account.
- Vá»›i Bitcoin, dá»¯ liá»‡u Tx cÃ³ thá»ƒ Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ káº¿t ná»‘i 1 Ä‘á»‹a chá»‰ tá»›i 1 Ä‘á»‹nh danh váº­t lÃ½.

## Tx riÃªng tÆ° trÃªn blockchain cÃ´ng khai
ChÃºng ta cÃ³ thá»ƒ sá»­ dá»¥ng commitments vÃ  zero knowledge proof Ä‘á»ƒ lÃ m Ä‘iá»u nÃ y.

<strong> Committed data </strong>: cam káº¿t ngáº¯n (áº©n) á»Ÿ trÃªn chuá»—i.
<strong> Proof ğ… </strong>: succinct Zero knowledge (Zk) proof:
- Committed Tx data nháº¥t quÃ¡n vá»›i tráº¡ng thÃ¡i commited hiá»‡n táº¡i.
- Committed update state thÃ¬ Ä‘Ãºng. Tá»« Ä‘Ã³, ai cÅ©ng cÃ³ thá»ƒ xÃ¡c thá»±c ğ….

Minh hoáº¡: ///

### Review: Commitment
ÄÆ°á»£c sá»­ dá»¥ng vá»›i nhiá»u má»¥c Ä‘Ã­ch, vÃ­ dá»¥ Äáº¥u giÃ¡ kÃ­n. NgÆ°á»i tham gia cam káº¿t giÃ¡, sau khi háº¿t thá»i gian thÃ¬ má»i ngÆ°á»i sáº½ má»Ÿ cam káº¿t cá»§a há». <br>
<strong> CÃº phÃ¡p </strong> 2 thuáº­t toÃ¡n: <br>
- commit(msg, r) -> com.  r lÃ  randombit, com lÃ  string ngáº¯n
- verify(msg, com, r) -> reject / accept.

### TÃ­nh báº£o máº­t
<strong> Binding </strong>: KhÃ´ng thá»ƒ táº¡o 2 valid openings cho com. <br>
Tá»©c lÃ : táº¡o ra com, (m1, r1), (m2, r2) mÃ :
- verify(m1, com, r1) = accept. VÃ 
- verify(m2, com, r2) = accept vá»›i m1 â‰  m2.

<strong> Hiding </strong>: Com khÃ´ng tiáº¿t lá»™ gÃ¬ vá» data Ä‘Ã£ committed. Tá»©c lÃ  com sáº½ Ä‘á»™c láº­p vá»›i m.

## zk-SNARK lÃ  gÃ¬?
### CÃ¡c khÃ¡i niá»‡m
Äá»ƒ verify 1 Tx, Validator cáº§n pháº£i xem thÃ´ng tin trong Tx Ä‘Ã³ vÃ  kiá»ƒm tra xem cÃ³ thoáº£ mÃ£n khÃ´ng. NhÆ°ng náº¿u cÃ¡c Tx lÃ  private thÃ¬ Validator sáº½ kiá»ƒm tra nhÆ° tháº¿ nÃ o? LÃºc nÃ y, zk-SNARK Ä‘Æ°á»£c ra Ä‘á»i.

<strong> SNARK </strong>: lÃ  1 proof ngáº¯n gá»n Ä‘á»ƒ chá»©ng minh 1 statement lÃ  Ä‘Ãºng. NgoÃ i ra, nÃ³ cáº§n nhanh Ä‘á»ƒ xÃ¡c thá»±c bá»Ÿi ngÆ°á»i xÃ¡c thá»±c. <br>
VÃ­ dá»¥: statement: "TÃ´i biáº¿t má»™t m mÃ  SHA256(m) = 0".
<strong> zk-SNARK </strong>: lÃ  SNARK khÃ´ng tiáº¿t lá»™ gÃ¬ vá» ná»™i dung. VÃ­ dá»¥ trong statement kia thÃ¬ zk-SNARK sáº½ khÃ´ng tiáº¿t lá»™ gÃ¬ vá» giÃ¡ trá»‹ cá»§a m.

á»¨ng dá»¥ng: 
- Private Tx
- zkBrigde: ná»‘i cÃ¡c chuá»—i khá»‘i
- tÃ­nh riÃªng tÆ° trong zk-Rollups

### KÄ© thuáº­t zk-SNARK

#### Arithmetic Circuits (AC)
Cho 1 trÆ°á»ng há»¯u háº¡n:  ğ”½={0, â€¦, ğ‘âˆ’1} vá»›i p lÃ  sá»‘ nguyÃªn tá»‘ > 2. <br>
Arithmetic Circuit: C: ğ”½^ğ‘› â‡¾ ğ”½. <br>
C láº¥y input lÃ  list gá»“m n pháº§n tá»­ thuá»™c F, output lÃ  1 pháº§n tá»­ thuá»™c F. <br>
|C| = sá»‘ gates trong máº¡ch C.
// minh hoáº¡

<strong> VÃ­ dá»¥: </strong>
- C_hash(h, m) = 0 náº¿u SHA256(m) = h, â‰ 0 náº¿u ngÆ°á»£c láº¡i.  |C_hash| ~ 20K gates
- C_sig(pk, msg, Ïƒ) = 0 náº¿u chá»¯ kÃ­ Ïƒ lÃ  há»£p lá»‡ trÃªn msg vá»›i pk.

#### Argument System
Cho má»™t AC: C(x, w) -> F vá»›i:
- x: lÃ  statement cÃ´ng khai
- w: secret witness. 

Prover P cáº§n thuyáº¿t phá»¥c cÃ¡c Verifier V ráº±ng tá»“n táº¡i w mÃ  C(x, w) = 0 nhÆ°ng khÃ´ng muá»‘n gá»­i w vÃ¬ lÃ½ do báº£o máº­t.

CÃ³ 2 loáº¡i argument systems: Interactive vs Non-interactives.
- Interactive: P <-> V tÆ°Æ¡ng tÃ¡c vá»›i nhau nhiá»u láº§n Ä‘á»ƒ V Ä‘á»“ng Ã½. CÃ¡ch nÃ y chá»‰ Ã¡p dá»¥ng vá»›i há»‡ thá»‘ng cÃ³ Ã­t V.
- Non-interactive: P chá»‰ gá»­i duy nháº¥t 1 msg lÃ  proof cho V. CÃ¡ch nÃ y cÃ³ Ã­ch khi cÃ³ nhiá»u Verifier (VÃ­ dá»¥ nhiá»u Validator muá»‘n xÃ¡c thá»±c 1 Tx).

#### NARK: Non-interactive Argument of Knowledge
Vá»›i máº¡ch C(x, w) â‡¾  ğ”½. <br>
<strong> Preprocessing </strong>: S(C) â‡¾ public parameters(Sp, Sv).

Minh hoáº¡:

Má»™t preprocessing NARK lÃ  bá»™ 3 (S, P, V):
- S(C) â‡¾ public parameters(Sp, Sv).
- P(Sp, x, w) â‡¾  proof  ğœ‹
- V(ğ‘£ğ‘, ğ’™, ğ…)  â‡¾  accept / reject

<strong> YÃªu cáº§u </strong>
- Complete: âˆ€ğ‘¥, ğ‘¤:  ğ¶(ğ’™, ğ’˜) = 0 â‡’ Pr[ V(ğ‘£ğ‘, ğ‘¥, P(ğ‘ğ‘, ğ’™, ğ’˜)) = accept] = 1.
- Argument of knowledge: V accepts â‡’ P biáº¿t ğ‘¤
- Zero knowledge: (ğ¶, ğ‘ğ‘,ğ‘£ğ‘ ,ğ’™, ğœ‹)  khÃ´ng tiáº¿t lá»™ gÃ¬ vá» ğ’˜

<strong> Succinct </strong>
Má»™t NARK gá»i lÃ  SNARK khi viá»‡c táº¡o ra vÃ  xÃ¡c minh proof vá»›i thá»i gian nhanh:
- S(ğ¶)  â‡¾  public parameters  (Sğ‘, Sğ‘£)
- P(ğ‘ğ‘, ğ’™, ğ’˜)  â‡¾  short proof  ğœ‹;   |ğœ‹|=ğ‘‚_ğœ†(ğ¥ğ¨ğ â¡(|ğ‘ª|)) 
- V(ğ‘£ğ‘, ğ’™, ğ…)    nhanh Ä‘á»ƒ tháº©m Ä‘á»‹nh:    time(V) = ğ‘‚_ğœ† (|ğ‘¥|, ğ¥ğ¨ğ â¡(|ğ‘ª|)).

Do Ä‘Ã³, vá»›i SNARK thÃ¬ viá»‡c Ä‘á»c toÃ n bá»™ máº¡ch C lÃ  khÃ´ng ká»‹p thá»i gian. VÃŒ váº­y cáº§n bÆ°á»›c preprocessing. 

<strong> TÃ³m láº¡i: </strong> 
- SNARK: bá»™ (S, P, V) thoáº£ mÃ£n: Complete, Argument of knowledge, Succinct.
- zk-SNARK: SNARK cÃ³ zero knowledge.

#### CÃ¡c loáº¡i Preprocessing
- trusted setup per circuit: S(C) sá»­ dá»¥ng data bÃ­ máº­t (VÃ­ dá»¥: randombit r). 
- trusted but universal: Randombit r Ä‘á»™c láº­p khá»i C: <br>
    S = (S_init, S_index) vá»›i: 
    - ğ‘†_ğ‘–ğ‘›ğ‘–ğ‘¡ (ğœ†;ğ‘Ÿ) â‡¾ U: 1 láº§n duy nháº¥t.
    - ğ‘†_ğ‘–ğ‘›ğ‘‘ğ‘’ğ‘¥ (U,ğ¶) â‡¾ (Sğ‘, Sğ‘£): KhÃ´ng chá»©a secret data.

#### Argurment of knowledge
P biáº¿t w náº¿u w cÃ³ thá»ƒ Ä‘Æ°á»£c extracted tá»« P. <br>
Bá»™ 3 (S, P, V) lÃ  Argurment of knowledge vá»›i máº¡ch C náº¿u:
- A = (A0, A1) lÃ  adversary mÃ  cÃ³ thá»ƒ bá»‹ extracted thÃ´ng tin:
    + S(C) â‡¾ (Sp, Sv),  A0(Sp) â‡¾ (x, st) 
    + ğœ‹ â‡½ A1(ğ‘ğ‘, ğ‘¥, st):   Pr[V(vp, ğ‘¥, ğœ‹) = accept] > 1/10^6	(khÃ´ng Ä‘Ã¡ng ká»ƒ )
- CÃ³ extractor E (sá»­ dá»¥ng A1 lÃ  blackbox) vÃ  táº¡o ra Ä‘Æ°á»£c w báº±ng tÆ°Æ¡ng tÃ¡c vá»›i A1(Sp, x, st).

#### Zero knowledge
Proof ğœ‹ khÃ´ng tiáº¿t lá»™ vá» ğ’˜ náº¿u Verifier tá»± táº¡o ğœ‹, hay Verifier khÃ´ng há»c Ä‘Æ°á»£c gÃ¬ tá»« proof ğœ‹. <br>
<strong> Tá»©c lÃ : </strong>
- Tá»“n táº¡i 1 hÃ m Sim() sao cho: (Sğ‘, Sğ‘£, ğœ‹) â‡½ Sim(ğ¶,ğ‘¥). Hay Sim() cÃ³ thá»ƒ táº¡o ra proof ğœ‹ mÃ  khÃ´ng cáº§n w.

## Lá»i káº¿t
á» trÃªn lÃ  sÆ¡ lÆ°á»£c vá» tÃ­nh riÃªng tÆ° trong Blockchain vÃ  cÃ¡i nhÃ¬n tá»•ng quan vá» zk-SNARK.




